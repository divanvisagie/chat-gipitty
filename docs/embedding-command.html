<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Embedding Command - Chat GipiTTY</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Chat GipiTTY</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="embedding-command"><a class="header" href="#embedding-command">Embedding Command</a></h1>
<p>The <code>embedding</code> subcommand generates embedding vectors for text using OpenAI's embedding models. Embeddings are dense numerical representations of text that capture semantic meaning and can be used for similarity search, clustering, and other machine learning tasks.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Embeddings convert text into high-dimensional vectors that represent the semantic meaning of the text. Similar texts will have similar embeddings, making them useful for:</p>
<ul>
<li>Semantic search and similarity matching</li>
<li>Text clustering and classification</li>
<li>Recommendation systems</li>
<li>Information retrieval</li>
<li>Machine learning feature vectors</li>
</ul>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<pre><code class="language-bash">cgip embedding [OPTIONS] [TEXT]
</code></pre>
<h3 id="arguments"><a class="header" href="#arguments">Arguments</a></h3>
<ul>
<li><code>[TEXT]</code> - Text to generate embeddings for. If not provided, reads from stdin</li>
</ul>
<h3 id="options"><a class="header" href="#options">Options</a></h3>
<ul>
<li><code>-m, --model &lt;MODEL&gt;</code> - Embedding model to use (default: text-embedding-3-small)</li>
<li><code>-o, --output &lt;OUTPUT&gt;</code> - Output file path. If not set, prints to stdout</li>
</ul>
<h2 id="basic-examples"><a class="header" href="#basic-examples">Basic Examples</a></h2>
<h3 id="generate-embeddings-for-text"><a class="header" href="#generate-embeddings-for-text">Generate Embeddings for Text</a></h3>
<pre><code class="language-bash"># Basic usage with text argument
cgip embedding "Hello, world!"
</code></pre>
<p>Output:</p>
<pre><code>-0.0123456789, 0.0234567890, -0.0345678901, 0.0456789012, ...
</code></pre>
<h3 id="read-from-stdin"><a class="header" href="#read-from-stdin">Read from stdin</a></h3>
<pre><code class="language-bash"># Pipe text to embedding command
echo "This is example text" | cgip embedding
</code></pre>
<h3 id="save-to-file"><a class="header" href="#save-to-file">Save to File</a></h3>
<pre><code class="language-bash"># Save embedding vector to file
cgip embedding "Important text" --output embedding.txt

# Read from stdin and save to file
echo "Text from stdin" | cgip embedding --output vector.txt
</code></pre>
<h2 id="model-options"><a class="header" href="#model-options">Model Options</a></h2>
<h3 id="available-models"><a class="header" href="#available-models">Available Models</a></h3>
<h4 id="text-embedding-3-small-default"><a class="header" href="#text-embedding-3-small-default">text-embedding-3-small (default)</a></h4>
<ul>
<li><strong>Dimensions</strong>: 1536</li>
<li><strong>Cost</strong>: Lower cost option</li>
<li><strong>Performance</strong>: Good for most use cases</li>
<li><strong>Speed</strong>: Faster processing</li>
</ul>
<pre><code class="language-bash">cgip embedding "sample text" --model text-embedding-3-small
</code></pre>
<h4 id="text-embedding-3-large"><a class="header" href="#text-embedding-3-large">text-embedding-3-large</a></h4>
<ul>
<li><strong>Dimensions</strong>: 3072</li>
<li><strong>Cost</strong>: Higher cost</li>
<li><strong>Performance</strong>: Best accuracy and quality</li>
<li><strong>Speed</strong>: Slower processing</li>
</ul>
<pre><code class="language-bash">cgip embedding "sample text" --model text-embedding-3-large
</code></pre>
<h4 id="text-embedding-ada-002-legacy"><a class="header" href="#text-embedding-ada-002-legacy">text-embedding-ada-002 (legacy)</a></h4>
<ul>
<li><strong>Dimensions</strong>: 1536</li>
<li><strong>Status</strong>: Legacy model, still supported</li>
<li><strong>Note</strong>: Consider upgrading to newer models</li>
</ul>
<pre><code class="language-bash">cgip embedding "sample text" --model text-embedding-ada-002
</code></pre>
<h2 id="advanced-examples"><a class="header" href="#advanced-examples">Advanced Examples</a></h2>
<h3 id="batch-processing"><a class="header" href="#batch-processing">Batch Processing</a></h3>
<pre><code class="language-bash"># Process multiple texts from a file
cat texts.txt | while read line; do
    echo "$line" | cgip embedding --output "embeddings/$(echo "$line" | tr ' ' '_').txt"
done
</code></pre>
<h3 id="compare-text-similarity"><a class="header" href="#compare-text-similarity">Compare Text Similarity</a></h3>
<pre><code class="language-bash"># Generate embeddings for comparison
cgip embedding "The cat sat on the mat" --output cat_text.txt
cgip embedding "A feline rested on the rug" --output feline_text.txt

# Use external tools to calculate cosine similarity
</code></pre>
<h3 id="document-processing"><a class="header" href="#document-processing">Document Processing</a></h3>
<pre><code class="language-bash"># Process documentation files
for file in docs/*.md; do
    filename=$(basename "$file" .md)
    cgip embedding --output "embeddings/${filename}.vec" -f "$file"
done
</code></pre>
<h3 id="search-index-creation"><a class="header" href="#search-index-creation">Search Index Creation</a></h3>
<pre><code class="language-bash"># Create embeddings for search index
find . -name "*.txt" -exec sh -c '
    filename=$(basename "$1" .txt)
    cgip embedding --output "search_index/${filename}.vec" -f "$1"
' _ {} \;
</code></pre>
<h2 id="input-handling"><a class="header" href="#input-handling">Input Handling</a></h2>
<p>The embedding command handles input in the following priority:</p>
<ol>
<li><strong>Text argument only</strong>: Uses the provided text argument</li>
<li><strong>Stdin only</strong>: Uses text from stdin (when no text argument is provided)</li>
<li><strong>Both stdin and text argument</strong>: Combines stdin text with argument text</li>
<li><strong>Neither</strong>: Shows error message</li>
</ol>
<h3 id="examples-of-input-combinations"><a class="header" href="#examples-of-input-combinations">Examples of Input Combinations</a></h3>
<pre><code class="language-bash"># Text argument only
cgip embedding "Hello world"

# Stdin only
echo "Hello world" | cgip embedding

# Both (combines stdin + argument)
echo "Hello" | cgip embedding "world"
# Results in embedding for: "Hello world"
</code></pre>
<h2 id="output-formats"><a class="header" href="#output-formats">Output Formats</a></h2>
<h3 id="standard-output-default"><a class="header" href="#standard-output-default">Standard Output (default)</a></h3>
<p>Comma-separated floating point numbers:</p>
<pre><code>-0.012345, 0.023456, -0.034567, 0.045678, ...
</code></pre>
<h3 id="file-output"><a class="header" href="#file-output">File Output</a></h3>
<p>Same format but written to specified file:</p>
<pre><code class="language-bash">cgip embedding "text" --output vector.txt
cat vector.txt
# -0.012345, 0.023456, -0.034567, 0.045678, ...
</code></pre>
<h2 id="integration-examples"><a class="header" href="#integration-examples">Integration Examples</a></h2>
<h3 id="with-python"><a class="header" href="#with-python">With Python</a></h3>
<pre><code class="language-python"># Process embedding output in Python
import subprocess
import numpy as np

def get_embedding(text):
    result = subprocess.run(
        ['cgip', 'embedding', text], 
        capture_output=True, 
        text=True
    )
    return np.array([float(x.strip()) for x in result.stdout.split(',')])

embedding = get_embedding("Hello world")
print(f"Embedding shape: {embedding.shape}")
</code></pre>
<h3 id="with-shell-scripts"><a class="header" href="#with-shell-scripts">With Shell Scripts</a></h3>
<pre><code class="language-bash">#!/bin/bash
# Generate embeddings for all text files

for file in *.txt; do
    echo "Processing $file..."
    basename=$(basename "$file" .txt)
    cgip embedding --output "${basename}.vec" -f "$file"
    echo "Saved embedding to ${basename}.vec"
done
</code></pre>
<h3 id="with-json-processing"><a class="header" href="#with-json-processing">With JSON Processing</a></h3>
<pre><code class="language-bash"># Create JSON structure with embeddings
jq -n --arg text "Hello world" --argjson embedding "$(cgip embedding "Hello world" | jq -R 'split(",") | map(tonumber)')" '{
    text: $text,
    embedding: $embedding,
    timestamp: now
}'
</code></pre>
<h2 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h2>
<h3 id="semantic-search"><a class="header" href="#semantic-search">Semantic Search</a></h3>
<pre><code class="language-bash"># Index documents
for doc in documents/*.txt; do
    cgip embedding -f "$doc" --output "index/$(basename "$doc").vec"
done

# Search for similar documents (requires similarity calculation)
cgip embedding "search query" --output query.vec
</code></pre>
<h3 id="content-recommendation"><a class="header" href="#content-recommendation">Content Recommendation</a></h3>
<pre><code class="language-bash"># Generate embeddings for user preferences
cgip embedding "user likes science fiction and technology" --output user_profile.vec

# Generate embeddings for content items
cgip embedding "article about artificial intelligence" --output content_item.vec
</code></pre>
<h3 id="text-classification"><a class="header" href="#text-classification">Text Classification</a></h3>
<pre><code class="language-bash"># Generate embeddings for training data
while IFS=',' read -r label text; do
    echo "$text" | cgip embedding --output "training/${label}_$(date +%s).vec"
done &lt; training_data.csv
</code></pre>
<h2 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h2>
<h3 id="no-input-provided"><a class="header" href="#no-input-provided">No Input Provided</a></h3>
<pre><code class="language-bash">cgip embedding
# Error: No text provided. Please provide text as an argument or via stdin.
</code></pre>
<h3 id="invalid-model"><a class="header" href="#invalid-model">Invalid Model</a></h3>
<pre><code class="language-bash">cgip embedding "text" --model invalid-model
# Error: Model 'invalid-model' not found
</code></pre>
<h3 id="output-file-issues"><a class="header" href="#output-file-issues">Output File Issues</a></h3>
<pre><code class="language-bash">cgip embedding "text" --output /root/readonly.txt
# Error: Cannot write to output file: Permission denied
</code></pre>
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<h3 id="1-choose-the-right-model"><a class="header" href="#1-choose-the-right-model">1. Choose the Right Model</a></h3>
<ul>
<li>Use <code>text-embedding-3-small</code> for most applications</li>
<li>Use <code>text-embedding-3-large</code> when accuracy is critical</li>
<li>Consider cost vs. performance trade-offs</li>
</ul>
<h3 id="2-preprocessing-text"><a class="header" href="#2-preprocessing-text">2. Preprocessing Text</a></h3>
<pre><code class="language-bash"># Clean and normalize text before embedding
echo "Text with    extra   spaces" | tr -s ' ' | cgip embedding
</code></pre>
<h3 id="3-batch-processing"><a class="header" href="#3-batch-processing">3. Batch Processing</a></h3>
<pre><code class="language-bash"># Process multiple texts efficiently
cat input_texts.txt | cgip embedding --output batch_embeddings.txt
</code></pre>
<h3 id="4-error-handling-in-scripts"><a class="header" href="#4-error-handling-in-scripts">4. Error Handling in Scripts</a></h3>
<pre><code class="language-bash">#!/bin/bash
if ! cgip embedding "test" &gt; /dev/null 2&gt;&amp;1; then
    echo "Error: Embedding service not available"
    exit 1
fi
</code></pre>
<h2 id="performance-considerations"><a class="header" href="#performance-considerations">Performance Considerations</a></h2>
<h3 id="token-limits"><a class="header" href="#token-limits">Token Limits</a></h3>
<ul>
<li>Each model has input token limits</li>
<li>Very long texts may be truncated</li>
<li>Consider splitting long documents</li>
</ul>
<h3 id="api-rate-limits"><a class="header" href="#api-rate-limits">API Rate Limits</a></h3>
<ul>
<li>Be mindful of API rate limits for batch processing</li>
<li>Add delays between requests if needed</li>
<li>Consider caching results</li>
</ul>
<h3 id="storage"><a class="header" href="#storage">Storage</a></h3>
<ul>
<li>Embedding vectors can be large (1536-3072 dimensions)</li>
<li>Consider compression for large-scale storage</li>
<li>Use appropriate data types (float32 vs float64)</li>
</ul>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="common-issues"><a class="header" href="#common-issues">Common Issues</a></h3>
<p><strong>API Key Issues</strong>:</p>
<pre><code class="language-bash"># Verify API key is set
echo $OPENAI_API_KEY

# Test with simple embedding
cgip embedding "test"
</code></pre>
<p><strong>Model Not Available</strong>:</p>
<pre><code class="language-bash"># List available models
cgip --list-models

# Use default model
cgip embedding "text" # Uses text-embedding-3-small
</code></pre>
<p><strong>Output File Problems</strong>:</p>
<pre><code class="language-bash"># Check directory permissions
ls -la output_directory/

# Use full path
cgip embedding "text" --output /full/path/to/output.txt
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="tts-command.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="agent-command.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="tts-command.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="agent-command.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
